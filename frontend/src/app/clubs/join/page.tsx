"use client";
import { useState } from 'react'; import { useRouter } from 'next/navigation'; import { useQuery } from '@tanstack/react-query'; import { apiClient } from '@/lib/api'; import { ProtectedLayout } from '@/components/layout/protected-layout'; import { Navbar } from '@/components/layout/navbar'; import { Card } from '@/components/ui/card'; import { Input } from '@/components/ui/input'; import { Button } from '@/components/ui/button';
export default function JoinClubPage(){ const [slug,setSlug]=useState(''); const [msg,setMsg]=useState(''); const router=useRouter(); const {data}=useQuery({queryKey:['clubs'],queryFn:apiClient.getClubs});
const join=async()=>{ const club=data?.find(c=>c.slug===slug); if(!club){setMsg('Club not found in your visible list. Need direct ID currently.'); return;} await apiClient.joinClub(club.id); setMsg('Joined'); router.push(`/clubs/${club.id}`); };
return <ProtectedLayout><Navbar/><main className="mx-auto max-w-md p-4"><Card><h1 className="mb-4 text-xl font-semibold">Join Club</h1><Input placeholder="Club slug" value={slug} onChange={e=>setSlug(e.target.value)}/><Button className="mt-3" onClick={join}>Join</Button>{msg&&<p className="mt-2 text-sm">{msg}</p>}</Card></main></ProtectedLayout>; }
